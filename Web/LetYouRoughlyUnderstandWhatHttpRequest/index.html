<!DOCTYPE html>
<html lang="TW">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>您的網路共筆-UrWeb</title>
  
      
        <meta name="description"
          content="文章作者: johch3n611u 創作日期: 2023/01/09 文章類型: Web，查看本文章獲取更多訊息。">
        
          <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous" />
          <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
            rel="stylesheet">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" />
          <link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" />
          
<link rel="stylesheet" href="/css/prism.css">

            
<link rel="stylesheet" href="/css/main.css">

              <!-- Google Tag Manager -->
              <script>(function (w, d, s, l, i) {
                  w[l] = w[l] || []; w[l].push({
                    'gtm.start':
                      new Date().getTime(), event: 'gtm.js'
                  }); var f = d.getElementsByTagName(s)[0],
                    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                      'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-T4FDJRJ');</script>
              <!-- End Google Tag Manager -->
              <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
                integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
                crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T4FDJRJ" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <header>
    <div class="mobileBox">
      <div class="brandBox">
        <a href="/" class="d-flex align-items-center">
          <h1 class="m-0">
            您的網路共筆
          </h1>
        </a>
      </div>
      <a href="#" id="barBtn"><i class="hamburger fa-solid fa-bars"></i></a>
    </div>
  </header>
  <!-- <h1>
      <a href="/">Home</a> |
      <a href="/archives">Archive</a> |
      tags
      <a href="/about/">About</a>
    </h1> -->
  <div class="outter-wrap container-fluid">
    <aside class="leftAside">
      <nav>
        <ul>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="input-group"><input type="search" name="q" class="input-group-input" placeholder="Search"><button type="submit" class="input-group-submit">Search</button><input type="hidden" name="sitesearch" value="https://urwebapp.github.io"></form>
            <!-- <li>
            <h4>
              <a href="/about/">關於我們</a>
            </h4>
          </li> -->
            <li style="margin-top: 50px;">
              <h4>
                <a href="#" id="authorsBtn">Authors <i class="fa-solid fa-square-caret-up"></i></a>
              </h4>
              <div id="authors">
                <ul class="author-list">
                  <li> 
                    <a href="/author/kai98k">kai98k</a>
                  </li>
                  <li> 
                    <a href="/author/johch3n611u">johch3n611u</a>
                  </li>
                </ul>
              </div>
            </li>
            <li>
              <h4>
                <a href="#" id="categoriesBtn">Categories <i class="fa-solid fa-square-caret-up"></i></a>
              </h4>
              <div id="categories">
                <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Back-End/">Back-End</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ComputerScience/">ComputerScience</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-Pattern/">Design Pattern</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Front-End/">Front-End</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Full-Stack/">Full-Stack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/computer-science/">computer-science</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%81%B7%E6%B6%AF%E7%99%BC%E5%B1%95/">職涯發展</a><span class="category-list-count">1</span></li></ul>
              </div>
            </li>
            <li>
              <h4>
                <a href="#" id="tagsBtn">Tags <i class="fa-solid fa-square-caret-up"></i></a>
              </h4>
              <div id="tags"><a href="/tags/Net/" style="font-size: 20px;">.Net</a> <a href="/tags/Angular/" style="font-size: 13.33px;">Angular</a> <a href="/tags/Architecture/" style="font-size: 10px;">Architecture</a> <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/ComputerScience/" style="font-size: 10px;">ComputerScience</a> <a href="/tags/DDD/" style="font-size: 10px;">DDD</a> <a href="/tags/ES6/" style="font-size: 10px;">ES6</a> <a href="/tags/Exception/" style="font-size: 10px;">Exception</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Internet/" style="font-size: 16.67px;">Internet</a> <a href="/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/tags/Log/" style="font-size: 13.33px;">Log</a> <a href="/tags/Note/" style="font-size: 16.67px;">Note</a> <a href="/tags/OOD-OOP/" style="font-size: 10px;">OOD/OOP</a> <a href="/tags/PDF/" style="font-size: 10px;">PDF</a> <a href="/tags/React/" style="font-size: 16.67px;">React</a> <a href="/tags/Request/" style="font-size: 10px;">Request</a> <a href="/tags/Response/" style="font-size: 10px;">Response</a> <a href="/tags/computer-science/" style="font-size: 10px;">computer-science</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/%E8%A8%AD%E8%A8%88%E6%80%9D%E8%80%83/" style="font-size: 10px;">設計思考</a> <a href="/tags/%E8%BD%89%E8%81%B7/" style="font-size: 10px;">轉職</a></div>
            </li>
        </ul>
      </nav>
    </aside>
          <main class="container postWrap">
  <article class="postArticle">
    <div class="postArticleHeader">
      <h1 class="pt-1">讓你大概搞懂 Http Request</h1>
      <div class="infoBox">
        <i class="fa fa-eye" aria-hidden="true"></i>
        <p class="waline-pageview-count" data-path="/Web/LetYouRoughlyUnderstandWhatHttpRequest/" />
        </p>
        <span>|</span>
        <p>2023/01/09</p>
        <span>|</span>
        <p>
          
            <a href="/categories/Web/ ">Web </a>
            
        </p>
        <span>|</span>
        <ul class="tagBox">
          
            <li>
              <a href="/tags/Internet/"><i class="fa-solid fa-tag"></i> Internet
              </a>
            </li>
            
            <li>
              <a href="/tags/Response/"><i class="fa-solid fa-tag"></i> Response
              </a>
            </li>
            
            <li>
              <a href="/tags/Request/"><i class="fa-solid fa-tag"></i> Request
              </a>
            </li>
            
            <li>
              <a href="/tags/Angular/"><i class="fa-solid fa-tag"></i> Angular
              </a>
            </li>
            
        </ul>
      </div>
    </div>
    <div class="postArticleContent">
      <div class="authorsWordsBox">
        <p class="title">johch3n611u</p>
        <p class="content">這個作者很懶，什麼都沒留下...</p>
      </div>
      <blockquote>
<p>此文章會不定時編修，如有錯誤在麻煩各位大神請不吝設指教，感謝！</p>
<p><code>TL;DR</code> 直接使用擅長的或是最新的，因為都是在 Http 協議下的交換資料方式，差異不會大到哪</p>
</blockquote>
<p>因為專案上有 Angular Forms 與 HttpClient 的需求，以往不管是用 fetch 或是 JQ 都直接實作也沒搞清楚差異，所以想針對這塊去做一些總整理，話不多說直接開幹；</p>
<p>網路通訊協議 (Internet Protocol) 是由網際網路協會底下的工作小組制定而成，主要是用來定義在兩個系統中傳播資訊的規格，以下列出一些我比較有興趣的，主要還是會以資料溝通的實例去比較，詳細的也可以直接參考 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/%E7%BD%91%E7%BB%9C%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE">網路傳輸協定 Wiki</a>。</p>
<details>
<summary>應用層：DNS、POP、FTP、HTTP、HTTPS、ONC/RPC、SSL、SSH、WebSocket</summary>

<ol>
<li>DNS (Domain Name System&#x2F;Service&#x2F;Server)：是網際網路的電話簿、地址冊，我覺得這蠻簡單的但就是<code>最後面的 S 對我來說超容易混亂的，簡單來講就是有 N 台 Server 他主要做的 Service 事情就是 Domain Name 對應 IP 這件事情</code>。</li>
<li>POP (Post Office Protocol)：支援使用客戶端遠端管理在伺服器上的電子郵件，套用了 SSL 後又被稱為 POP3S (POP - Version 3)，而與 IMAP (Internet Message Access Protocol) 差異在於能否用不同台電腦存取郵件，<code>但這在實務上目前也沒碰到這麼深，多使用套件解決掉</code>。</li>
<li>FTP (File Transfer Protocol)：用於在電腦網路上在客戶端和伺服器之間進行檔案傳輸，套上 SSL 則為 SFTP，實務上以 C# 來講也像是 POP 一樣，通常會有 FTPExtensions 或是郵件的 package 庫，可以直接套用，<code>比較有印象的只有 IIS 上設置 FTP 進行上版</code>。</li>
<li>HTTP、HTTPS (HyperText Transfer Protocol Secure)：HTTPS 其實就是 HTTP 套用 SSL，最初提供一種發布和接收HTML頁面的方法，<code>衍生也能請求 URI (Uniform Resource Identifiers) 統一資源標識符 包含像是 HTML檔案、程式碼、影片、圖片等等，而衍生的還有 URN (Uniform Resource Name) 資源名稱、URL (Uniform Resource Locator) 資源位址地址</code>。</li>
<li>ONC&#x2F;RPC (Open Network Computing Remote Procedure Call)：一種被廣泛應用的遠端程序呼叫系統，第一次見到這個詞是在 2019 的 .net conf 上，但對當時還是小菜雞的我來說用不到就沒詳細去理解了，相較於而此 RPC 較多看到的是 gRPC 是不限於語言的高效能遠端程序呼叫架構，gRPC 就像 Web 常用的 Restful API 一樣，都是在處理請求和回應，並且進行資料交換 (分為 Unary、Server streaming、Client streaming、Bidirectional streaming)，但 gRPC 還多了其他的功能和特色 ( 其實就像是 Restful 結合 Websocket )，主要的交換資料可以由 JSON 改為 (Protocol Buffer) 協議緩衝區，<code>因為沒有需求這就不深入去研究了，差異比較可以看看這篇</code> <a target="_blank" rel="noopener" href="https://blog.csdn.net/sun007700/article/details/99672063">RPC vs Restful</a>。</li>
<li>SSL (Secure Sockets Layer)：是一種安全協議，讓客戶端與主機之間建立一個密碼連結，現被 TLS (Transport Layer Security) 取代，<code>主要就是瀏覽器與伺服器 Handshake 的方式會有所不同，並且使用 CA (Certificate Authority) 所頒發的憑證交換來進行身分確認，</code>在這開發上來講如同前列一樣只要知道原理，使用套件或架構設定就好。</li>
<li>SSH (Secure Shell)：有加密過的遠程連線，主要透過<code>公私鑰加解密</code>，公鑰用來讓別人確認你的簽名的正確性，並將東西加密為只有你私鑰能夠解密，私鑰責用來製作簽名與解密。</li>
<li>WebSocket：可在單個 TCP (Transmission Control Protocol) 傳輸層協議，連接上進行全雙工通訊，瀏覽器和伺服器只需要完成一次交握，兩者之間就可以建立永續性的連接，並進行雙向資料傳輸。<code>自己玩的時候碰過 SignalR (微軟的 WebSocket 架構，提供伺服器端與客戶端的 Library 讓開發簡易化很多)，還有 Firebase RxJS，還看過 PHP 類似 WebSocket 的架構會在 Network 看到瘋狂 Request/Response，但真的開發一般的網站系統上好像比較少這方面的需求</code>。</li>
</ol>
</details>

<h2 id="AJAX-amp-API"><a href="#AJAX-amp-API" class="headerlink" title="AJAX &amp; API"></a>AJAX &amp; API</h2><h3 id="AJAX-Asynchronous-JavaScript-and-XML"><a href="#AJAX-Asynchronous-JavaScript-and-XML" class="headerlink" title="AJAX (Asynchronous JavaScript and XML)"></a>AJAX (Asynchronous JavaScript and XML)</h3><blockquote>
<p>Asynchronous &#x3D; 非同步 &#x3D; 異步</p>
</blockquote>
<p>以往<code>同步請求</code>，前端透過 URL 或 Form 發出 Synchronous Request 與後端溝通，必須要接收到後端的 Synchronous Response 才能繼續下一步動作。<br><code>非同步請求</code>則是類似抽號碼牌的概念，抽完號碼牌發出 Asynchronous Request 則就可以去做其他事情等叫號再來執行領取資料。</p>
<p>而 JavaScript and XML 則是指這是一套透過 JavaScript 執行上述動作的網頁開發技術，溝通的資料格式為 XML (Extensible Markup Language)，但現在資料格式不局限於 XML 但 AJAX 還是延續下來。</p>
<h3 id="API-Application-Programming-Interface"><a href="#API-Application-Programming-Interface" class="headerlink" title="API (Application Programming Interface)"></a>API (Application Programming Interface)</h3><blockquote>
<p>應用程式 <code>介面：兩種不同物質或狀態之間的接觸面</code>。</p>
</blockquote>
<p>所以不限於人對物 e.g. 麥當勞點餐機、手機、汽車面板 etc…</p>
<p>還包括機器對機器 e.g. 點餐機對中控點餐系統、手機 APP 對 APP 伺服器、汽車系統對汽車音響 etc …</p>
<p>所以以下 Request 多半是瀏覽器大廠根據 RFC Http 傳輸協議，去提供的函式庫 API 讓你可以操控瀏覽器去對後端伺服器發送 Request 或以之為基底所封裝的高階一點的函式庫。</p>
<h2 id="Request-溝通實例"><a href="#Request-溝通實例" class="headerlink" title="Request 溝通實例"></a>Request 溝通實例</h2><p>在 AG 中應該通常都使用 HttpClient 直接存取資料內容，從下面可以看到，這是以 XMLHttpRequest API Http 協議，再包一層 RxJS observable 的 API，製作成觀察者設計模式的易用組件。</p>
<blockquote>
<p>What Is HttpClient? <code>HttpClient</code> is a built-in service class available in the @angular&#x2F;common&#x2F;http package. It has multiple signature and return types for each request. It uses the <code>RxJS</code> observable-based APIs, which means it returns the observable and what we need to subscribe it. This API was developed based on <code>XMLHttpRequest</code> interface exposed by browsers.</p>
</blockquote>
<h3 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest"></a>XMLHttpRequest</h3><blockquote>
<p><code>優點：</code></p>
<p>不重新載入頁面的情況下更新網頁。<br>在頁面已載入後向伺服器請求&#x2F;接收資料。<br>在背景程式向伺服器發送資料。</p>
</blockquote>
<blockquote>
<p><code>缺點：</code></p>
<p>使用起來也比較繁瑣，需要設置很多值。<br>早期的IE瀏覽器有自己的實現，這樣需要寫兼容代碼。</p>
</blockquote>
<p>記得一開始接觸程式，除了 JQ 以外第一個學習與後端溝通的方式，就是透過 XMLHttpRequest 與 Element form、fetch、JQ AJAX、Element form，xhr 詳細的方法可以參考 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/API/XMLHttpRequest">MDN XMLHttpRequest</a>。</p>
<pre class="line-numbers language-Javascript" data-language="Javascript"><code class="language-Javascript">&#x2F;&#x2F; let promise &#x3D; new Promise((resolve, reject) &#x3D;&gt; &#123;
    let xhr &#x3D; new XMLHttpRequest ();
    &#x2F;&#x2F; open (method, url, async, user, password)
    xhr.open (&quot;GET&quot;, &quot;server.txt&quot;, false); &#x2F;&#x2F;建立连接 async true 才可以指定 responseType
    &#x2F;&#x2F; setRequestHeader (header, value)
    xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application&#x2F;x-www-form-urlencoded&quot;); &#x2F;&#x2F; 設置標頭
    xhr.onreadystatechange &#x3D; () &#x3D;&gt; &#123; &#x2F;&#x2F; Call a function when the state changes.
        if (xhr.readyState &#x3D;&#x3D;&#x3D; XMLHttpRequest.DONE &amp;&amp; xhr.status &#x3D;&#x3D;&#x3D; 200) &#123;
            &#x2F;&#x2F; Request finished. Do processing here.
        &#125;   else if (xhr.status &#x3D;&#x3D;&#x3D; 404) &#123;
            &#x2F;&#x2F; Do something when file not found
        &#125;
    &#125;
    &#x2F;&#x2F; xhr.responseType &#x3D; &#39;json&#39;; &#x2F;&#x2F; 回應是 JSON
    &#x2F;&#x2F; send (body)
    xhr.send(null);  &#x2F;&#x2F;发送请求
    console.log(xhr.responseText);  &#x2F;&#x2F;接收数据

    xhr.onload &#x3D; function () &#123;
        &#x2F;&#x2F; Do something when response loaded
    &#125;;
&#x2F;&#x2F; &#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>XMLHttpRequest Response</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">XMLHttpRequest</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
 <span class="token literal-property property">onabort</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">onerror</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">onload</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">onloadend</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">onloadstart</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">onprogress</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token function-variable function">onreadystatechange</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>…<span class="token punctuation">&#125;</span>
 <span class="token literal-property property">ontimeout</span><span class="token operator">:</span> <span class="token keyword">null</span>
 <span class="token literal-property property">readyState</span><span class="token operator">:</span> <span class="token number">4</span>
 <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"&#123;'TEST':'ASDASD'&#125;"</span>
 <span class="token literal-property property">responseText</span><span class="token operator">:</span> <span class="token string">"&#123;'TEST':'ASDASD'&#125;"</span>
 <span class="token literal-property property">responseType</span><span class="token operator">:</span> <span class="token string">"text"</span>
 <span class="token literal-property property">responseURL</span><span class="token operator">:</span> <span class="token string">"http://127.0.0.1:8080/server.txt"</span>
 <span class="token literal-property property">responseXML</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
 <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span>
 <span class="token literal-property property">statusText</span><span class="token operator">:</span> <span class="token string">"OK"</span>
 <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">0</span>
 <span class="token literal-property property">upload</span><span class="token operator">:</span> XMLHttpRequestUpload <span class="token punctuation">&#123;</span><span class="token literal-property property">onloadstart</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">onprogress</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">onabort</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">onerror</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">onload</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> …<span class="token punctuation">&#125;</span>
 <span class="token literal-property property">withCredentials</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><blockquote>
<p><code>優點：</code></p>
<p>簡單的跨域的處理。<br>底層 API 相較於 XHR 可以輕鬆處理格式，也可以容易地被其他技術使用 e.g. Service Workers。<br>支持 Promise API</p>
</blockquote>
<blockquote>
<p><code>缺點：</code></p>
<p>報錯的部分封裝的並不好，需要額外去處理。<br>cookie 需要額外的設定並沒有 default。<br>不支援超時、拒絕 timeout 控制。<br>無法像 XHR 監測 Request 進度。</p>
</blockquote>
<p>與上述來看感覺最大差異是在反傳 Promise 與內部是回傳 Response 物件，相較於 XMLHttpRequest 應用較為方便，多了許多處理資料的方法，提供的方法與參數詳細可以參考 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/API/Fetch_API/Using_Fetch">MDN Fetch</a></p>
<blockquote>
<p>Promise 物件代表一個即將完成、或失敗的非同步操作，以及它所產生的值。</p>
</blockquote>
<pre class="line-numbers language-Javascript" data-language="Javascript"><code class="language-Javascript">&#x2F;&#x2F; let promise&lt;Response&gt; &#x3D; fetch(url, &#123;options&#125;)
fetch(&#39;server.txt&#39;) &#x2F;&#x2F; return Promise&lt;Response&gt;
.then((response) &#x3D;&gt; &#123;
    response.json().then((data) &#x3D;&gt; &#123;
            ...
    &#125;);
&#125;)
.catch((err) &#x3D;&gt; &#123; ... &#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Fetch Response</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">Response</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
    <span class="token literal-property property">bodyUsed</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> Headers <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token literal-property property">redirected</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span>
    <span class="token literal-property property">statusText</span><span class="token operator">:</span> <span class="token string">"OK"</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"basic"</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"http://127.0.0.1:8080/server.txt"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Fetch Options</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// &#123;options&#125;</span>
<span class="token punctuation">&#123;</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// must match 'Content-Type' header</span>
    <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token string">'no-cache'</span><span class="token punctuation">,</span> <span class="token comment">// *default, no-cache, reload, force-cache, only-if-cached</span>
    <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">'same-origin'</span><span class="token punctuation">,</span> <span class="token comment">// include, same-origin, *omit</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">'user-agent'</span><span class="token operator">:</span> <span class="token string">'Mozilla/4.0 MDN Example'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token comment">// *GET, POST, PUT, DELETE, etc.</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span> <span class="token comment">// no-cors, cors, *same-origin</span>
    <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'follow'</span><span class="token punctuation">,</span> <span class="token comment">// manual, *follow, error</span>
    <span class="token literal-property property">referrer</span><span class="token operator">:</span> <span class="token string">'no-referrer'</span><span class="token punctuation">,</span> <span class="token comment">// *client, no-referrer</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="JQuery-ajax"><a href="#JQuery-ajax" class="headerlink" title="JQuery ajax"></a>JQuery ajax</h3><blockquote>
<p><code>優點：</code></p>
<p>對原生 XHR 的封裝，做了兼容處理，簡化了使用。<br>增加了對 JSONP 的支持，可以簡單處理部分跨域。</p>
</blockquote>
<blockquote>
<p><code>缺點：</code></p>
<p>如果有多個請求，並且有依賴關係的話，容易形成回調地獄。<br>本身是針對 MVC 的架構，不符合現在前端 MVVM 。<br>ajax 是 jQuery中的一個方法。如果只是要使用 ajax 卻要引入整個 jQuery 會很大包。</p>
</blockquote>
<p>JQ 說實在的也比較在個人專案有使用，後續接觸到框架不管是 Vue 或 AG 通常就是使用 fetch 或 Axios，並且搭配框架的 Render，使用上跟上述兩種方式其實也差不多，從官網 <a target="_blank" rel="noopener" href="https://api.jquery.com/jquery.ajax/">jquery.ajax</a> 也可以知道基底是 XMLHttpRequest 只是說有在封裝得更好用一些，且可以利用 JQ 特性鍊式做一些使用上的變化。</p>
<pre class="line-numbers language-Js" data-language="Js"><code class="language-Js">$.ajax(&#123;
    beforeSend:(xhr)&#x3D;&gt;&#123;xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application&#x2F;x-www-form-urlencoded&quot;)&#125;,
    url: &#39;server.txt&#39;,
    method: &#39;GET&#39;, &#x2F;&#x2F; 1.9.0
    &#x2F;&#x2F; type: &#39;GET&#39;, &#x2F;&#x2F; prior to 1.9.0.
    dataType: &#39;json&#39;, &#x2F;&#x2F; 希望 server 回傳的資料類型
    processData: false, &#x2F;&#x2F; 預先處理，是否將 data 轉成 query string
    contentType: false, &#x2F;&#x2F; 指定傳送到 server 的資料類型
    &#x2F;&#x2F; data: &#123;
    &#x2F;&#x2F;     &#x2F;&#x2F; data send to backend
    &#x2F;&#x2F;     status: &#39;send request &#39;,
    &#x2F;&#x2F; &#125;,
    success: (success) &#x3D;&gt; &#123; console.log(&#39;success&#39;, success); &#125;,
    error: (error) &#x3D;&gt; &#123; console.log(&#39;error&#39;, error) &#125;,
&#125;).done((response) &#x3D;&gt; &#123;
    console.log(typeof (response), response);
&#125;).fail(function (jqXHR, textStatus, errorThrown) &#123;
    console.log(&#39;fail&#39;, textStatus, errorThrown);
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-Js" data-language="Js"><code class="language-Js">$.ajax(&#123;...&#125;).then(function()&#123;
     return $.ajax(&#123;...&#125;);
&#125;).then(function()&#123;
     return $.ajax(&#123;...&#125;);
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Axios"><a href="#Axios" class="headerlink" title="Axios"></a>Axios</h3><blockquote>
<p><code>優點：</code></p>
<p>可在 node.js 中使用<br>支持 Promise API<br>攔截處理 &#x2F; 錯誤處理 &#x2F; 超時處理 &#x2F; 格式處理<br>支援防禦 XSRF</p>
</blockquote>
<blockquote>
<p><code>缺點：</code></p>
<p>較新的瀏覽器才能使用。</p>
</blockquote>
<p>這個套件說實在也沒用過幾次，比較多搭配 Vue 使用，但我主要是開發 AG 的，所以這裡就只列出基本使用方式，感覺跟 JQ 也沒有太大差異，主要是其輕量化、與 fetch 一樣反傳 promise 物件，不限於瀏覽器在node.js中也能使用，提供 axios.create 類似於 Router 管理 API 的介面，詳細請直接參考 <a target="_blank" rel="noopener" href="https://axios-http.com/zh/docs/intro">Axios 官方文件</a>。</p>
<pre class="line-numbers language-Javascript" data-language="Javascript"><code class="language-Javascript">axios.get(&#39;server.txt&#39;)
.then(function (response) &#123;
        console.log(typeof(response),response);
        console.log(arguments) &#x2F;&#x2F; 對應傳入函式之引數的類陣列物件
        &#x2F;&#x2F; 引數是當我們呼叫函式時傳遞給它的值
        &#x2F;&#x2F; 參數是我們在函式定義中所列出的變數
&#125;)
.catch(function (error) &#123;
        console.log(error);
&#125;)
.finally(function () &#123;
        console.log(&#39;finally&#39;);
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h3><p>談到透過 Form 傳遞就離不開 method &#x3D; “POST&#x2F;GET” ，Get 之於明信片、Post 之於信件，使用 Get 時使用 Query String (Key&#x2F;Vaule) 加註在 Request Header Url 之後，而 Post 則在 Request body 內加註檔案內容，且抓取 form 標籤內有 name 的對應欄位去做參數化，這方式似乎是類似透過 URLSearchParams API 進行對 Url 的修改達到 Query String 的方式，POST 則是將參數放置到 Body 然後也是進行類似上述方式，使用 form 若無設定 <a target="_blank" rel="noopener" href="https://www.w3school.com.cn/tags/att_form_enctype.asp">enctype ContentType 會預設為 application&#x2F;x-www-form-urlencoded</a>，指的是送出前會將空格轉為+、特殊符號轉為 ASCII HEX 值 ( 但我用 Live Server 都默認 text&#x2F;html; charset&#x3D;UTF-8 可能協議有改? )，這關係到下一單元所講的 ContentType：multipart&#x2F;form-data。</p>
<blockquote>
<p>URLSearchParams + Url + XHR</p>
</blockquote>
<pre class="line-numbers language-Js" data-language="Js"><code class="language-Js">let uRLSearchParams &#x3D; new URLSearchParams();
const userName &#x3D; document.querySelector(&#39;#username&#39;);
const password &#x3D; document.querySelector(&#39;#password&#39;);
uRLSearchParams.append(&#39;username&#39;, userName);
uRLSearchParams.append(&#39;passward&#39;, password);
let url &#x3D; new URL(&#96;$&#123;document.location.origin&#125;$&#123;document.location.pathname&#125;&#96;);
url.search &#x3D; uRLSearchParams;
console.log(&#39;url.href&#39;,url.href); &#x2F;&#x2F; http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;index.html?username&#x3D;null&amp;passward&#x3D;null
&#x2F;&#x2F; 再透過 xhr get request<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Form Get</p>
</blockquote>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

// Header

// GET /?username=010101&amp;password=010101 HTTP/1.1
// Host: xxx.toright.com
// User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-TW; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 GTB7.1 ( .NET CLR 3.5.30729)
// Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
// Accept-Language: zh-tw,en-us;q=0.7,en;q=0.3
// Accept-Encoding: gzip,deflate
// Accept-Charset: UTF-8,*
// Keep-Alive: 115
// Connection: keep-alive<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Form Post</p>
</blockquote>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

// 封包內

// POST / HTTP/1.1
// Host: xxx.toright.com
// User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-TW; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 GTB7.1 ( .NET CLR 3.5.30729)
// Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
// Accept-Language: zh-tw,en-us;q=0.7,en;q=0.3
// Accept-Encoding: gzip,deflate
// Accept-Charset: UTF-8,*
// Keep-Alive: 115
// Connection: keep-alive
// Content-Type: application/x-www-form-urlencoded
// code>Content-Length: 9
// username=&amp;password=&amp;id=010101<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="FormData"><a href="#FormData" class="headerlink" title="FormData"></a>FormData</h3><p>FormData API 可以將表單資料建立相對應的的（key&#x2F;string）集合，特點是可以傳送二進制檔案（File、Blob)，並且可以將上傳檔案、圖片、影片與複數個資料合併 (<code>一般的 Content-Type 往往只能傳送一種形式的資料</code>)，並用 XMLHttpRequest.send() 一次傳送出去。它在編碼類型設定為 multipart&#x2F;form-data 時會採用與表單相同的格式送出，也可以利用它的 API 快速的去針對資料做轉格式、加密、驗證、錯誤處理、狀態轉換、Accessibility等其餘處理 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/API/FormData">MDN FormData</a>。</p>
<blockquote>
<p>以下三種 ContentType 應該是最常使用到的了</p>
<ul>
<li>multipart&#x2F;form-data：表單支援的格式，可以將不同格式的內容包在一起，可以夾帶檔案，但似乎是 key&#x2F;string 無法像 JSON 有基礎資料型別</li>
<li>application&#x2F;json：API 常用的檔案交換格式，純文字，不支援二進位內容，SAP 通常用 JSON 與後端 Restful 交換資料</li>
<li>text&#x2F;plain：純文字內容，實際應用中不常出現</li>
</ul>
</blockquote>
<blockquote>
<p>延伸閱讀 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5871640/why-is-using-onclick-in-html-a-bad-practice">why-is-using-onclick-in-html-a-bad-practice</a> ( TL;DR 關注點分離 &gt; 資安 )</p>
</blockquote>
<pre class="line-numbers language-Js" data-language="Js"><code class="language-Js">&#x2F;&#x2F; 動態增加表單的資料
&#x2F;&#x2F; var formData &#x3D; new FormData();
&#x2F;&#x2F; formData.append(&#39;username&#39;, Chris); &#x2F;&#x2F; 增加欄位
&#x2F;&#x2F; formData.append(&#39;image&#39;, file); &#x2F;&#x2F; 檔案也可以透過 append 放進來

&lt;form&gt;
    &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;fileName&quot;&#x2F;&gt;
    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot;&#x2F;&gt;
    &lt;button type&#x3D;&quot;submit&quot; onClick&#x3D;&quot;customSubmit(event)&quot;&gt;&lt;&#x2F;button&gt;
&lt;&#x2F;form&gt;

function customSubmit (event)&#123; &#x2F;&#x2F; event 可帶可不帶
    event.preventDefault(); &#x2F;&#x2F; 取消 submit 原生事件
    &#x2F;&#x2F; 直接根據表單元素取得表單資料
    let form &#x3D; document.querySelector(&#39;form&#39;);
    let formData &#x3D; new FormData(form);
    for(let [key, value] of formData)&#123;
         console.log(data);
    &#125;
    FormData.has(&#39;fieldName&#39;) &#x2F;&#x2F; 檢驗表單中是否有該欄位
    ...
    &#x2F;&#x2F; 再透過 xhr get request
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><p>終於到重點了，此篇文章主要整理使用上的差異，AG 就不提一些基本的部分了，接著上！</p>
<h3 id="Angular-HttpClient"><a href="#Angular-HttpClient" class="headerlink" title="Angular HttpClient"></a>Angular HttpClient</h3><ul>
<li>延伸閱讀 RxJS</li>
<li><a target="_blank" rel="noopener" href="https://fullstackladder.dev/blog/2020/09/25/mastering-rxjs-10-functional-programming-basic-patterns/">Functional Programming</a></li>
<li><a target="_blank" rel="noopener" href="https://codewithstyle.info/functional-javascript-part-8-functional-reactive-programming-rxjs/">Reactive Programming</a></li>
</ul>
<p>HttpClient 應該沒什麼好講的如前文<a href="#%E6%BA%9D%E9%80%9A%E5%AF%A6%E4%BE%8B">所述</a>，主要的注意事項可以參考保哥的<a target="_blank" rel="noopener" href="https://blog.miniasp.com/post/2019/01/20/Angular-HttpClient-Pitfall-and-Tricks">在 Angular 使用 HttpClient 的各種 TypeScript 地雷與陷阱</a>，主要應該是要熟悉對於 RxJS 的應用，先前專案都沒有進階應用比較少實作反應式的程式，在近期專案看到類似 <a target="_blank" rel="noopener" href="https://rxjs-cn.github.io/learn-rxjs-operators/operators/combination/combinelatest.html">combineLatest</a> 這種使用方式，結合兩個 Observables 去做應用，但 <code>OS 較長開發後端私心來說感覺前端不應該把資料組合搞得這麼複雜，感覺後端處理掉就好...</code>。</p>
<pre class="line-numbers language-Js" data-language="Js"><code class="language-Js">constructor(private httpClient: HttpClient) &#123;
    this.subscribe &#x3D; this.httpClient
    .get&lt;any&gt;(this.url)
    .pipe(()&#x3D;&gt;&#123;
            &#x2F;&#x2F; ...logic
    &#125;).subscribe(res &#x3D;&gt; &#123;
            this.res &#x3D; res;
    &#125;);
&#125;

ngOnDestroy()
&#123;
    this.subscribe.unsubscribe();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Angular-Template-Driven-Forms"><a href="#Angular-Template-Driven-Forms" class="headerlink" title="Angular Template-Driven Forms"></a>Angular Template-Driven Forms</h3><p>這部分在網路上有找到詳細的大神系列文章 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/m/users/20090728/ironman/3881">Angular 深入淺出三十天：表單與測試</a> 而且還有前端的測試範例，直接找到下個研究方向！</p>
<p>Template-Driven 相較於 Reactive Forms 較為簡易，透過 Html 原生的驗證或是 AG Validator Directive 可以快速的實作驗證，之前專案上有撇除兩者自製的驗證模組，對於這兩者比較沒有使用到，但像是多個欄位之間會有複雜的驗證，抑或是動態的驗證，甚至連表單的欄位是動態，這種需求也有遇到過，確實是蠻麻煩的，似乎可以透過 Reactive Forms 處理。</p>
<p>這裡比較少用到的地方是 <code>範本語法</code> 感覺蠻像原生 js 的 getElement，但在 AG 這取得的會是 NgModel、NgForm 或 HTMLFormElement 包裝好的物件，以往都是搭配 ViewChild 操作 DOM，這裡直接使用 NgModel 所提供的參數 value、error，並抓取 NgForm invalid 參數卡控欄位，後面的就是基本 AG 操作了，相較於先前專案自製驗證確實快速且簡單。</p>
<blockquote>
<p>Html</p>
</blockquote>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">#form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ngForm<span class="token punctuation">"</span></span> <span class="token attr-name">(ngSubmit)</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>帳號：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span>
      <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span>
      <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span>
      <span class="token attr-name">required</span>
      <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>\b[\w\.-]+@[\w\.-]+\.\w&#123;2,4&#125;\b<span class="token punctuation">"</span></span>
      <span class="token attr-name">#accountNgModel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ngModel<span class="token punctuation">"</span></span>
      <span class="token attr-name">[ngModel]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span>
      <span class="token attr-name">(ngModelChange)</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>accountValueChange(accountNgModel.value, accountNgModel.errors)<span class="token punctuation">"</span></span>
    <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; accountErrorMessage &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>密碼：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">required</span>
      <span class="token attr-name">#passwordNgModel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ngModel<span class="token punctuation">"</span></span>
      <span class="token attr-name">[minlength]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8<span class="token punctuation">"</span></span>
      <span class="token attr-name">[maxlength]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>16<span class="token punctuation">"</span></span>
      <span class="token attr-name">[ngModel]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">(ngModelChange)</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>passwordValueChange(passwordNgModel.value, passwordNgModel.errors)<span class="token punctuation">"</span></span>
    <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; passwordErrorMessage &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">[disabled]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form.invalid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登入<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Typescript</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token punctuation">&#123;</span>

  <span class="token comment">// 綁定在帳號欄位上</span>
  account <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token comment">// 綁定在密碼欄位上</span>
  password <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token comment">// 帳號欄位的錯誤訊息</span>
  accountErrorMessage <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token comment">// 密碼欄位的錯誤訊息</span>
  passwordErrorMessage <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 綁定在帳號欄位上，當使用者改變登入帳號時，會觸發此函式，並取得對應的錯誤訊息
   *
   * @param &#123;string&#125; account
   * @param &#123;ValidationErrors&#125; errors
   */</span>
  <span class="token function">accountValueChange</span><span class="token punctuation">(</span>account<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">errors</span><span class="token operator">:</span> ValidationErrors<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validationCheck</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token string">'account'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>


  <span class="token comment">/**
   * 綁定在密碼欄位上，當使用者改變密碼時會觸發此函式
   *
   * @param &#123;string&#125; password
   * @param &#123;ValidationErrors&#125; errors
   */</span>
  <span class="token function">passwordValueChange</span><span class="token punctuation">(</span>password<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">errors</span><span class="token operator">:</span> ValidationErrors<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validationCheck</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 綁定在表單上，當使用者按下登入按鈕時會觸發此函式</span>
  <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// do login...</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 透過欄位裡的 ValidationErrors 來設定該欄位的錯誤訊息
   *
   * @param &#123;ValidationErrors&#125; errors 欲驗證的欄位的錯誤 (by Angular)
   * @param &#123;'account' | 'password'&#125; fieldName 欄位名稱
   */</span>
  <span class="token keyword">private</span> <span class="token function">validationCheck</span><span class="token punctuation">(</span>
    <span class="token literal-property property">errors</span><span class="token operator">:</span> ValidationErrors<span class="token punctuation">,</span>
    <span class="token literal-property property">fieldName</span><span class="token operator">:</span> <span class="token string">'account'</span> <span class="token operator">|</span> <span class="token string">'password'</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token literal-property property">errorMessage</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>errors<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">.</span>required<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'此欄位必填'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">.</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'格式有誤，請重新輸入'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">.</span>minlength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'密碼長度最短不得低於8碼'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setErrorMessage</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">,</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 設定指定欄位的錯誤訊息
   *
   * @param &#123;'account' | 'password'&#125; fieldName 欲設定錯誤訊息的欄位名稱
   * @param &#123;string&#125; errorMessage 欲設定的錯誤訊息
   */</span>
  <span class="token keyword">private</span> <span class="token function">setErrorMessage</span><span class="token punctuation">(</span>
    <span class="token literal-property property">fieldName</span><span class="token operator">:</span> <span class="token string">'account'</span> <span class="token operator">|</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">errorMessage</span><span class="token operator">:</span> string
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fieldName <span class="token operator">===</span> <span class="token string">'account'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>accountErrorMessage <span class="token operator">=</span> errorMessage<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>passwordErrorMessage <span class="token operator">=</span> errorMessage<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Angular-Model-Driven-Forms-Reactive-Forms"><a href="#Angular-Model-Driven-Forms-Reactive-Forms" class="headerlink" title="Angular Model-Driven Forms ( Reactive Forms )"></a>Angular Model-Driven Forms ( Reactive Forms )</h3><p>對於 Reactive Forms，我其實比較好奇進階使用 ( <code>多個欄位之間會有複雜的驗證，抑或是動態的驗證，甚至連表單的欄位是動態</code> )，但這部分在原文章好像放在比較後面，那就先學會怎麼使用吧，如果有需要再自行到原文觀看；</p>
<p>Model-Driven Form 是將表單用程式的方式產生，主要 Directive 成員有最外層的 formGroup 與內層的 formControl ( formControlName, formGroupName, formArrayName )，很類似之前開發過 .Net 的 Webform 控制項或是 Razor 的表單驗證，在 Reactive Forms 需要透過這些 Directive 與 Template 的 Form Element 做資料綁定透過 formBuilder.group 將 AG 所提供的 Directive 與 Validators 與表單綁定，這跟之前專案自製過的驗證模組原理相通，但多了更多 AG 所提供的物件，相對的也比較複雜，感覺可以斟酌使用。</p>
<blockquote>
<p>Html</p>
</blockquote>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">[formGroup]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>formGroup<span class="token punctuation">"</span></span> <span class="token attr-name">(ngSubmit)</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>帳號：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span>
      <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>account<span class="token punctuation">"</span></span>
      <span class="token attr-name">[formControl]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>accountControl<span class="token punctuation">"</span></span>
    <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; getErrorMessage(accountControl) &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>密碼：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>
      <span class="token attr-name">[formControl]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>passwordControl<span class="token punctuation">"</span></span>
    <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; getErrorMessage(passwordControl) &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">[disabled]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>formGroup.invalid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登入<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>Typescript</p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoginComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">&#123;</span>

  <span class="token comment">// 綁定在表單上</span>
  <span class="token literal-property property">formGroup</span><span class="token operator">:</span> FormGroup<span class="token punctuation">;</span>

  <span class="token comment">/**
   * 用以取得帳號欄位的表單控制項
   */</span>
  <span class="token keyword">get</span> <span class="token function">accountControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> FormControl <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>formGroup<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'account'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> FormControl<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 用以取得密碼欄位的表單控制項
   */</span>
  <span class="token keyword">get</span> <span class="token function">passwordControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> FormControl <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>formGroup<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> FormControl<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 透過 DI 取得 FromBuilder 物件，用以建立表單
   */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> <span class="token literal-property property">formBuilder</span><span class="token operator">:</span> FormBuilder</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 當 Component 初始化的時候初始化表單
   */</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>formGroup <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>formBuilder<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      <span class="token literal-property property">account</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>
          Validators<span class="token punctuation">.</span>required<span class="token punctuation">,</span>
          Validators<span class="token punctuation">.</span><span class="token function">pattern</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\b[\w\.-]+@[\w\.-]+\.\w&#123;2,4&#125;\b$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>
          Validators<span class="token punctuation">.</span>required<span class="token punctuation">,</span>
          Validators<span class="token punctuation">.</span><span class="token function">minLength</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          Validators<span class="token punctuation">.</span><span class="token function">maxLength</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// 綁定在表單上，當使用者按下登入按鈕時會觸發此函式</span>
  <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// do login...</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">/**
   * 透過該欄位的表單控制項來取得該欄位的錯誤訊息
   *
   * @param &#123;FormControl&#125; formControl 欲取得錯誤訊息的欄位的表單控制項 (by Angular)
   */</span>
  <span class="token function">getErrorMessage</span><span class="token punctuation">(</span>formControl<span class="token operator">:</span> FormControl<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token literal-property property">errorMessage</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>formControl<span class="token punctuation">.</span>errors <span class="token operator">||</span> formControl<span class="token punctuation">.</span>pristine<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>formControl<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>required<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'此欄位必填'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>formControl<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'格式有誤，請重新輸入'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>formControl<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>minlength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'密碼長度最短不得低於8碼'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>formControl<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>maxlength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      errorMessage <span class="token operator">=</span> <span class="token string">'密碼長度最長不得超過16碼'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> errorMessage<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/TCP/IP%E5%8D%8F%E8%AE%AE%E6%97%8F">網際網路協議套組 Wiki</a></li>
<li><a target="_blank" rel="noopener" href="https://www.telerik.com/blogs/angular-basics-how-to-use-httpclient">Angular Basics: How To Use HttpClient in Angular</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/5995.html">JS XMLHttpRequest入门教程（非常详细）</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10219106">簡介 SSL、TLS 協定</a></li>
<li><a target="_blank" rel="noopener" href="https://codecharms.me/posts/security-ssh">[Security] 你該知道所有關於 SSH 的那些事</a></li>
<li><a target="_blank" rel="noopener" href="https://openhome.cc/Gossip/ECMAScript/ResponseType.html">使用 responseType</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35549547/fetch-api-vs-xmlhttprequest">[stackoverflow]fetch-api-vs-xmlhttprequest</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sun007700/article/details/99672063">普通socket, rpc, websocket,http(restful)等</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/9855127/setting-xmlhttprequest-responsetype-forbidden-all-of-a-sudden">setting-xmlhttprequest-responsetype-forbidden-all-of-a-sudden</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.toright.com/posts/1203/%E6%B7%BA%E8%AB%87-http-method%EF%BC%9A%E8%A1%A8%E5%96%AE%E4%B8%AD%E7%9A%84-get-%E8%88%87-post-%E6%9C%89%E4%BB%80%E9%BA%BC%E5%B7%AE%E5%88%A5%EF%BC%9F.html">淺談 HTTP Method：表單中的 GET 與 POST 有什麼差別？</a></li>
<li><a target="_blank" rel="noopener" href="https://marionma-69293.medium.com/form-%E6%A0%BC%E5%BC%8F%E6%98%AF%E4%BB%80%E9%BA%BC-%E6%88%91%E5%8F%AA%E6%9C%83%E5%82%B3-json-%E6%B7%BA%E8%AB%87-urlsearchparams-and-formdata-9da9a65e66ca">「Form 格式是什麼？我只會傳 JSON。」</a></li>
<li><a target="_blank" rel="noopener" href="https://pjchender.blogspot.com/2018/08/js-javascript-url-parameters.html">[JS] 使用 JavaScript 解析網址與處理網址中的參數（URL Parameters）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.kalan.dev/2021-03-13-form-and-form-data">form 標籤與 FormData 的應用</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10293658">拾捌。淺談幾種 POST request 的格式</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10195280">[功能介紹-10] Reactive Forms (Model-Driven Forms)</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/m/users/20090728/ironman/3881">Angular 深入淺出三十天：表單與測試</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.crazyalu.com/2016/10/26/angular-model-driven/">Angular 2 Forms 介紹：Model-Driven Forms</a></li>
</ul>

    </div>
  </article>
  <div class="postNext d-flex justify-content-between mt-3 mb-3">
    
      <h4>
        <a href="/computer-science/NoNeedUpgradeHardwareAdjustComputerPerformanceThroughSoftware/"><i class="fa-solid fa-angles-left"></i> 免升級硬體，透過軟體調整電腦性能
        </a>
      </h4>
      
        
          <h4>
            <a href="/Back-End/NET6LogToolWatchDog/">
              .NET 6 輕量視覺化 Log 工具 WatchDog <i class="fa-solid fa-angles-right"></i>
            </a>
          </h4>
          
  </div>
  
  <div id="waline"></div>
  <script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    let option = '{"el":"#waline","enable":true,"serverURL":"https://waline-urweb.vercel.app/","placeholder":"歡迎隨時提出您的建議，並不吝指教","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":"en","visitor":true,"comment_count":true,"requiredFields":["nick","mail"],"libUrl":"https://cdnjs.cloudflare.com/ajax/libs/waline/2.14.5/waline.js","pageview":true,"reaction":true}';
    init(JSON.parse(option));
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>
  
    <input style="display:none" onload="addTotalViews()">
</main>
            
              <aside class="rightAside">
                <section>
                  <h4>Table of contents</h4>
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AJAX-amp-API"><span class="toc-text">AJAX &amp; API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AJAX-Asynchronous-JavaScript-and-XML"><span class="toc-text">AJAX (Asynchronous JavaScript and XML)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API-Application-Programming-Interface"><span class="toc-text">API (Application Programming Interface)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Request-%E6%BA%9D%E9%80%9A%E5%AF%A6%E4%BE%8B"><span class="toc-text">Request 溝通實例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XMLHttpRequest"><span class="toc-text">XMLHttpRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fetch"><span class="toc-text">Fetch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JQuery-ajax"><span class="toc-text">JQuery ajax</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Axios"><span class="toc-text">Axios</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Form"><span class="toc-text">Form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FormData"><span class="toc-text">FormData</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Angular"><span class="toc-text">Angular</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-HttpClient"><span class="toc-text">Angular HttpClient</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-Template-Driven-Forms"><span class="toc-text">Angular Template-Driven Forms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-Model-Driven-Forms-Reactive-Forms"><span class="toc-text">Angular Model-Driven Forms ( Reactive Forms )</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%83%E8%80%83"><span class="toc-text">參考</span></a></li></ol>
                </section>
              </aside>

              <button class="mobileBtn btn"><i class="fa-solid fa-book-bookmark"></i></button>

              <div class="modal" tabindex="-1" id="tocModal">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Table of Contents</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                        onclick="tocModalClose()"></button>
                    </div>
                    <div class="modal-body">
                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AJAX-amp-API"><span class="toc-text">AJAX &amp; API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AJAX-Asynchronous-JavaScript-and-XML"><span class="toc-text">AJAX (Asynchronous JavaScript and XML)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API-Application-Programming-Interface"><span class="toc-text">API (Application Programming Interface)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Request-%E6%BA%9D%E9%80%9A%E5%AF%A6%E4%BE%8B"><span class="toc-text">Request 溝通實例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XMLHttpRequest"><span class="toc-text">XMLHttpRequest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fetch"><span class="toc-text">Fetch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JQuery-ajax"><span class="toc-text">JQuery ajax</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Axios"><span class="toc-text">Axios</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Form"><span class="toc-text">Form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FormData"><span class="toc-text">FormData</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Angular"><span class="toc-text">Angular</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-HttpClient"><span class="toc-text">Angular HttpClient</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-Template-Driven-Forms"><span class="toc-text">Angular Template-Driven Forms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Angular-Model-Driven-Forms-Reactive-Forms"><span class="toc-text">Angular Model-Driven Forms ( Reactive Forms )</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%83%E8%80%83"><span class="toc-text">參考</span></a></li></ol>
                    </div>
                  </div>
                </div>
              </div>

              
  </div>
  <footer class="cotainer-fluid">
    <p id="milestone" class="text-center m-0">
      <span>Copyright © 2021-2023 UrWeb. All rights reserved.</span><br>
      <span>This site is in orbit around internet 1 days.</span>
      <span>people witnessed it all</span>
    </p>
  </footer>

  <!-- <h3>categories</h3>
    <ul>
      
      <li>
        <a href="/categories/ComputerScience/"> ComputerScience  </a>
      </li>
      
      <li>
        <a href="/categories/Back-End/"> Back-End  </a>
      </li>
      
      <li>
        <a href="/categories/computer-science/"> computer-science  </a>
      </li>
      
      <li>
        <a href="/categories/React/"> React  </a>
      </li>
      
      <li>
        <a href="/categories/Web/"> Web  </a>
      </li>
      
      <li>
        <a href="/categories/%E8%81%B7%E6%B6%AF%E7%99%BC%E5%B1%95/"> 職涯發展  </a>
      </li>
      
      <li>
        <a href="/categories/Front-End/"> Front-End  </a>
      </li>
      
      <li>
        <a href="/categories/Design-Pattern/"> Design Pattern  </a>
      </li>
      
      <li>
        <a href="/categories/Javascript/"> Javascript  </a>
      </li>
      
      <li>
        <a href="/categories/Full-Stack/"> Full-Stack  </a>
      </li>
      
    </ul>

    <h3>tags</h3>
    <ul>
      
      <li>
        <a href="/tags/ComputerScience/"> ComputerScience </a>
      </li>
      
      <li>
        <a href="/tags/Net/"> .Net </a>
      </li>
      
      <li>
        <a href="/tags/Exception/"> Exception </a>
      </li>
      
      <li>
        <a href="/tags/Filter/"> Filter </a>
      </li>
      
      <li>
        <a href="/tags/Log/"> Log </a>
      </li>
      
      <li>
        <a href="/tags/computer-science/"> computer-science </a>
      </li>
      
      <li>
        <a href="/tags/Note/"> Note </a>
      </li>
      
      <li>
        <a href="/tags/React/"> React </a>
      </li>
      
      <li>
        <a href="/tags/Git/"> Git </a>
      </li>
      
      <li>
        <a href="/tags/%E8%BD%89%E8%81%B7/"> 轉職 </a>
      </li>
      
      <li>
        <a href="/tags/%E8%A8%AD%E8%A8%88%E6%80%9D%E8%80%83/"> 設計思考 </a>
      </li>
      
      <li>
        <a href="/tags/Internet/"> Internet </a>
      </li>
      
      <li>
        <a href="/tags/node-js/"> node.js </a>
      </li>
      
      <li>
        <a href="/tags/npm/"> npm </a>
      </li>
      
      <li>
        <a href="/tags/PDF/"> PDF </a>
      </li>
      
      <li>
        <a href="/tags/Architecture/"> Architecture </a>
      </li>
      
      <li>
        <a href="/tags/C/"> C# </a>
      </li>
      
      <li>
        <a href="/tags/DDD/"> DDD </a>
      </li>
      
      <li>
        <a href="/tags/OOD-OOP/"> OOD/OOP </a>
      </li>
      
      <li>
        <a href="/tags/Javascript/"> Javascript </a>
      </li>
      
      <li>
        <a href="/tags/ES6/"> ES6 </a>
      </li>
      
      <li>
        <a href="/tags/Response/"> Response </a>
      </li>
      
      <li>
        <a href="/tags/Request/"> Request </a>
      </li>
      
      <li>
        <a href="/tags/Angular/"> Angular </a>
      </li>
      
    </ul> -->
</body>


<script src="/js/prism.js"></script>

  
<script src="/js/main.js"></script>


</html>