import{a as Y}from"./chunk-NVIMS4BT.js";import{b as j,d as N,f as Q,h as H,i as q,l as z,m as G,n as J,o as K,q as X}from"./chunk-SXBCIAQM.js";import{a as U}from"./chunk-BHYHBSD6.js";import{C as M,F as f,H as V,I as t,J as n,K as O,N as P,O as u,P as I,Q as F,R as D,S as R,T as a,U as w,V as y,W as x,X as d,Y as _,Z as C,aa as S,ba as h,ja as T,ka as A,la as k,na as B,o as m,p as c,sa as W,u as g,ua as L,x as v,y as b}from"./chunk-AM3MBALI.js";var $=["fileInput"];function ee(p,l){if(p&1&&(t(0,"option",26),a(1),n()),p&2){let o=l.$implicit;f("value",o.voiceURI),g(),x(" ",o.name," (",o.lang,") ")}}function te(p,l){if(p&1&&(t(0,"p"),a(1),n()),p&2){let o=I();V("success",o.isImportSuccess)("error",!o.isImportSuccess),g(),y(" ",o.importMessage," ")}}var Z=class p{constructor(l,o){this.ttsService=l;this.storageService=o}voices=[];selectedVoiceURI=null;defaultRepeatCount=1;rate=1;volume=1;sentenceDelay=500;fileInput;importMessage="";isImportSuccess=!1;ngOnInit(){setTimeout(()=>{this.voices=this.ttsService.getVoices()},300);let l=this.storageService.getSettings();this.selectedVoiceURI=l.ttsVoiceURI,this.defaultRepeatCount=l.defaultRepeatCount,this.rate=l.rate,this.volume=l.volume,this.sentenceDelay=l.sentenceDelay}onSettingsChange(){let l={ttsVoiceURI:this.selectedVoiceURI,defaultRepeatCount:this.defaultRepeatCount,rate:this.rate,volume:this.volume,sentenceDelay:this.sentenceDelay};this.storageService.saveSettings(l)}onExport(){let l=this.storageService.exportData(),o=new Blob([l],{type:"application/json"}),e=window.URL.createObjectURL(o),i=document.createElement("a");i.href=e,i.download=`listening-tool-backup-${new Date().toISOString().slice(0,10)}.json`,i.click(),window.URL.revokeObjectURL(e),i.remove()}triggerImport(){this.fileInput.nativeElement.click()}onFileSelected(l){let o=l.target;if(!o.files||o.files.length===0)return;let e=o.files[0],i=new FileReader;i.onload=s=>{let r=s.target?.result;if(confirm("\u8B66\u544A\uFF1A\u9019\u5C07\u6703\u8986\u84CB\u60A8\u73FE\u6709\u7684\u6240\u6709\u6587\u672C\u8CC7\u6599\uFF0C\u78BA\u5B9A\u8981\u7E7C\u7E8C\u55CE\uFF1F")){let E=this.storageService.importData(r);this.isImportSuccess=E.success,this.importMessage=E.message}},i.readAsText(e),o.value=""}static \u0275fac=function(o){return new(o||p)(v(Y),v(U))};static \u0275cmp=b({type:p,selectors:[["app-settings"]],viewQuery:function(o,e){if(o&1&&F($,5),o&2){let i;D(i=R())&&(e.fileInput=i.first)}},decls:56,vars:20,consts:[["fileInput",""],[1,"container"],[1,"setting-item"],["for","voice"],["id","voice",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["for","repeat"],["type","number","id","repeat","min","1",3,"ngModelChange","change","ngModel"],[1,"setting-item","slider-container"],["for","rate"],[1,"slider-wrapper"],["type","range","id","rate","min","0.5","max","2","step","0.1",3,"ngModelChange","change","ngModel"],[1,"slider-value"],["for","volume"],["type","range","id","volume","min","0","max","1","step","0.1",3,"ngModelChange","change","ngModel"],["for","delay"],["type","range","id","delay","min","0","max","5000","step","100",3,"ngModelChange","change","ngModel"],[1,"description"],[1,"data-management"],[3,"click"],[1,"import-btn",3,"click"],["type","file","hidden","","accept",".json",3,"change"],[3,"success","error",4,"ngIf"],[1,"footer-actions"],["type","button","routerLink","/"],[3,"value"]],template:function(o,e){if(o&1){let i=P();t(0,"div",1)(1,"h1"),a(2,"\u8A2D\u5B9A"),n(),t(3,"h2"),a(4,"\u8A9E\u97F3\u8A2D\u5B9A"),n(),t(5,"div",2)(6,"label",3),a(7,"\u9078\u64C7\u8A9E\u97F3/\u53E3\u97F3:"),n(),t(8,"select",4),C("ngModelChange",function(r){return m(i),_(e.selectedVoiceURI,r)||(e.selectedVoiceURI=r),c(r)}),u("change",function(){return m(i),c(e.onSettingsChange())}),t(9,"option",5),a(10,"\u700F\u89BD\u5668\u9810\u8A2D"),n(),M(11,ee,2,3,"option",6),n()(),t(12,"div",2)(13,"label",7),a(14,"\u9810\u8A2D\u91CD\u8907\u6B21\u6578:"),n(),t(15,"input",8),C("ngModelChange",function(r){return m(i),_(e.defaultRepeatCount,r)||(e.defaultRepeatCount=r),c(r)}),u("change",function(){return m(i),c(e.onSettingsChange())}),n()(),t(16,"div",9)(17,"label",10),a(18,"\u8A9E\u901F:"),n(),t(19,"div",11)(20,"input",12),C("ngModelChange",function(r){return m(i),_(e.rate,r)||(e.rate=r),c(r)}),u("change",function(){return m(i),c(e.onSettingsChange())}),n(),t(21,"span",13),a(22),S(23,"number"),n()()(),t(24,"div",9)(25,"label",14),a(26,"\u97F3\u91CF:"),n(),t(27,"div",11)(28,"input",15),C("ngModelChange",function(r){return m(i),_(e.volume,r)||(e.volume=r),c(r)}),u("change",function(){return m(i),c(e.onSettingsChange())}),n(),t(29,"span",13),a(30),S(31,"number"),n()()(),t(32,"div",9)(33,"label",16),a(34,"\u53E5\u9593\u5EF6\u9072:"),n(),t(35,"div",11)(36,"input",17),C("ngModelChange",function(r){return m(i),_(e.sentenceDelay,r)||(e.sentenceDelay=r),c(r)}),u("change",function(){return m(i),c(e.onSettingsChange())}),n(),t(37,"span",13),a(38),S(39,"number"),n()()(),O(40,"hr"),t(41,"h2"),a(42,"\u8CC7\u6599\u7BA1\u7406"),n(),t(43,"p",18),a(44,"\u60A8\u53EF\u4EE5\u532F\u51FA\u6240\u6709\u6587\u672C\u8CC7\u6599\u4F5C\u70BA\u5099\u4EFD\uFF0C\u6216\u5F9E\u5099\u4EFD\u6A94\u6848\u4E2D\u532F\u5165\u3002"),n(),t(45,"div",19)(46,"button",20),u("click",function(){return m(i),c(e.onExport())}),a(47,"\u532F\u51FA\u8CC7\u6599"),n(),t(48,"button",21),u("click",function(){return m(i),c(e.triggerImport())}),a(49,"\u532F\u5165\u8CC7\u6599"),n(),t(50,"input",22,0),u("change",function(r){return m(i),c(e.onFileSelected(r))}),n()(),M(52,te,2,5,"p",23),t(53,"div",24)(54,"button",25),a(55,"\u8FD4\u56DE"),n()()()}o&2&&(g(8),d("ngModel",e.selectedVoiceURI),g(),f("ngValue",null),g(2),f("ngForOf",e.voices),g(4),d("ngModel",e.defaultRepeatCount),g(5),d("ngModel",e.rate),g(2),w(h(23,11,e.rate,"1.1-1")),g(6),d("ngModel",e.volume),g(2),w(h(31,14,e.volume,"1.1-1")),g(6),d("ngModel",e.sentenceDelay),g(2),y("",h(39,17,e.sentenceDelay/1e3,"1.1-1")," \u79D2"),g(14),f("ngIf",e.importMessage))},dependencies:[B,T,A,k,X,G,J,j,H,q,z,N,K,Q,L,W],styles:["h2[_ngcontent-%COMP%]{font-size:1.3rem;border-bottom:1px solid var(--border-color);padding-bottom:.5rem;margin-top:2rem;margin-bottom:1.5rem}h2[_ngcontent-%COMP%]:first-of-type{margin-top:0}.setting-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1.5rem}.setting-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem}.slider-container[_ngcontent-%COMP%]   .slider-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.slider-container[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]{flex-grow:1}.slider-container[_ngcontent-%COMP%]   .slider-value[_ngcontent-%COMP%]{font-weight:700;min-width:50px;text-align:right}hr[_ngcontent-%COMP%]{border:none;border-top:1px solid var(--border-color);margin:2rem 0}.description[_ngcontent-%COMP%]{color:var(--text-muted-color);margin-bottom:1rem}.data-management[_ngcontent-%COMP%]{display:flex;gap:1rem}.data-management[_ngcontent-%COMP%]   .import-btn[_ngcontent-%COMP%]{background-color:var(--secondary-color)}.data-management[_ngcontent-%COMP%]   .import-btn[_ngcontent-%COMP%]:hover{background-color:var(--secondary-hover-color)}.success[_ngcontent-%COMP%]{color:#28a745;margin-top:1rem}.error[_ngcontent-%COMP%]{color:var(--danger-color);margin-top:1rem}.footer-actions[_ngcontent-%COMP%]{margin-top:2rem;text-align:right}@media (min-width: 768px){.setting-item[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between}.setting-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0;margin-right:1rem;flex-shrink:0}.setting-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .setting-item[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .slider-container[_ngcontent-%COMP%]   .slider-wrapper[_ngcontent-%COMP%]{width:300px}}"]})};export{Z as SettingsComponent};
