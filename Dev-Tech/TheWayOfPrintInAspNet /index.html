<!DOCTYPE html>
<html lang="TW">
  
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- 您的網路共筆-UrWeb -->
  <title>
    
      幾種 .net 列印的方式 |  
    
    您的網路共筆
  </title>
  
  
    <meta name="description"
          content="文章作者: kai98k 創作日期: 2023/02/05 文章類型: Dev Tech，查看本文章獲取更多訊息。">
  
          <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous" />
          <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
            rel="stylesheet">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" />
          <link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" />
          
<link rel="stylesheet" href="/assets/hexo/css/prism.css">

            
<link rel="stylesheet" href="/assets/hexo/css/main.css">

              <!-- Google Tag Manager -->
              <script>(function (w, d, s, l, i) {
                  w[l] = w[l] || []; w[l].push({
                    'gtm.start':
                      new Date().getTime(), event: 'gtm.js'
                  }); var f = d.getElementsByTagName(s)[0],
                    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                      'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-T4FDJRJ');</script>
              <!-- End Google Tag Manager -->
              <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
                integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
                crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body onload="responsiveIframe()">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T4FDJRJ" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <header>
    <div class="mobileBox">
      <div class="brandBox">
        <a href="/" class="d-flex align-items-center">
          <h1 class="m-0">
            您的網路共筆
          </h1>
        </a>
      </div>
      <div class="desktop-show"> <form action="//google.com/search" method="get" accept-charset="UTF-8" class="input-group"><input type="search" name="q" class="input-group-input" placeholder="Search"><button type="submit" class="input-group-submit">Search</button><input type="hidden" name="sitesearch" value="https://urwebapp.github.io"></form>
      </div>
      <a href="#" id="barBtn">
        <span>hamburger-icon</span>
        <!-- <i class="hamburger fa-solid fa-bars"></i> -->
        <!-- <span class="material-symbols-outlined">menu</span> -->
        <img class="hamburger" src="./assets/hexo/img/download.png" data-original="/assets/hexo/img/burger-menu-svgrepo-com.svg" alt="hamburger-icon">
      </a>
    </div>
  </header>
  <!-- <h1>
      <a href="/">Home</a> |
      <a href="/archives">Archive</a> |
      tags
      <a href="/about/">About</a>
    </h1> -->
  <div class="outterWrap container-fluid">
    <aside class="leftAside">
      <nav>
        <ul>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="d-md-none input-group"><input type="search" name="q" class="d-md-none input-group-input" placeholder="Search"><button type="submit" class="d-md-none input-group-submit">Search</button><input type="hidden" name="sitesearch" value="https://urwebapp.github.io"></form>
            <!-- <li>
            <h4>
              <a href="/about/">關於我們</a>
            </h4>
          </li> -->
            <li style="margin-top: 50px;">
              <h4>
                <a href="https://forms.gle/Mzn7eLEtW3oiscMT6" target="_blank">Contact / Subscribe</a>
              </h4>
            </li>
            <li>
              <h4>
                <a href="#" id="authorsBtn">Authors
                  <!-- <i class="fa-solid fa-square-caret-up"></i> -->
                  <div class="uponIcon"></div>
                </a>
              </h4>
              <div id="authors">
                <ul class="author-list">
                  <li>
                    <a href="/author/kai98k">kai98k</a>
                  </li>
                  <li>
                    <a href="/author/johch3n611u">johch3n611u</a>
                  </li>
                </ul>
              </div>
            </li>
            <li>
              <h4>
                <a href="#" id="categoriesBtn">Categories 
                  <!-- <i class="fa-solid fa-square-caret-up"></i> -->
                  <div class="uponIcon"></div>
                </a>
              </h4>
              <div id="categories">
                <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI-Tools/">AI Tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dev/">Dev</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dev-Tech/">Dev Tech</a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Language/">Language</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/f2e/">f2e</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%89%E8%81%B7%E6%88%90%E9%95%B7/">轉職成長</a><span class="category-list-count">2</span></li></ul>
              </div>
            </li>
            <li>
              <h4>
                <a href="#" id="tagsBtn">Tags 
                  <div class="uponIcon"></div>
                  <!-- <i class="fa-solid fa-square-caret-up"></i> -->
                </a>
              </h4>
              <div id="tags"><a href="/tags/Net/" style="font-size: 20px;">.Net</a> <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/Angular/" style="font-size: 17.5px;">Angular</a> <a href="/tags/Architecture/" style="font-size: 10px;">Architecture</a> <a href="/tags/Authorization/" style="font-size: 10px;">Authorization</a> <a href="/tags/C/" style="font-size: 12.5px;">C#</a> <a href="/tags/Computer-Science/" style="font-size: 10px;">Computer Science</a> <a href="/tags/DDD/" style="font-size: 10px;">DDD</a> <a href="/tags/ES6/" style="font-size: 10px;">ES6</a> <a href="/tags/English/" style="font-size: 15px;">English</a> <a href="/tags/Exception/" style="font-size: 10px;">Exception</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/GTM/" style="font-size: 10px;">GTM</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/Internet/" style="font-size: 17.5px;">Internet</a> <a href="/tags/JavaScript/" style="font-size: 12.5px;">JavaScript</a> <a href="/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/tags/Log/" style="font-size: 12.5px;">Log</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/OOD-OOP/" style="font-size: 10px;">OOD/OOP</a> <a href="/tags/PDF/" style="font-size: 10px;">PDF</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/Request/" style="font-size: 10px;">Request</a> <a href="/tags/Response/" style="font-size: 10px;">Response</a> <a href="/tags/Tools/" style="font-size: 10px;">Tools</a> <a href="/tags/Visual-Studio/" style="font-size: 10px;">Visual Studio</a> <a href="/tags/computer-science/" style="font-size: 10px;">computer-science</a> <a href="/tags/f2e/" style="font-size: 10px;">f2e</a></div>
            </li>
            <li style="margin-top: 50px;">
              <h4>
                <a href="https://urwebapp.github.io/assets/angular/ec/index.html" target="_blank">EC Demo</a>
                <a href="https://urwebapp.github.io/assets/angular/mod/EnglishLearningHelper/index.html" target="_blank">EnglishLearningHelper</a>
              </h4>
            </li>
        </ul>
      </nav>
    </aside>
    <main class="container postWrap">
  <article class="postArticle">
    <div class="postArticleHeader">
      <h1 class="pt-1">幾種 .Net 列印的方式</h1>
      <div class="infoBox">
        <i class="fa fa-eye" aria-hidden="true"></i>
        <p class="waline-pageview-count" data-path="/Dev-Tech/TheWayOfPrintInAspNet /" />
        </p>
        <span>|</span>
        <p>2023/02/05</p>
        <span>|</span>
        <p>
          
            <a href="/categories/Dev-Tech/ ">Dev Tech </a>
            
        </p>
        <span>|</span>
        <ul class="tagBox">
          
            <li>
              <a href="/tags/Net/">
                <!-- <i class="fa-solid fa-tag"></i>  -->
                <div class="tagIcon"></div>
                .Net
              </a>
            </li>
            
            <li>
              <a href="/tags/PDF/">
                <!-- <i class="fa-solid fa-tag"></i>  -->
                <div class="tagIcon"></div>
                PDF
              </a>
            </li>
            
        </ul>
      </div>
    </div>
    <div class="postArticleContent">
      <div class="authorsWordsBox">
        <p class="title">kai98k</p>
        <p class="content">這個作者很懶，什麼都沒留下...</p>
      </div>
      <p>通常印表機可以傳送 ZPL 或是直接透過驅動程式來觸發列印程序，本文主要講的是後者的列印方式。</p>
<h2 id="安裝驅動"><a href="#安裝驅動" class="headerlink" title="安裝驅動"></a>安裝驅動</h2><p>我們要先讓電腦認識印表機及溝通的埠道，可至 <a target="_blank" rel="noopener" href="https://www.seagullscientific.com/tw/support/downloads/drivers/">BarTender</a> 安裝相對應的驅動。</p>
<ol>
<li>下載完後選擇連接方式</li>
</ol>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/IjBDcBJ.png" alt="步驟1"></p>
<ol start="2">
<li>指定印表機型號</li>
</ol>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/u5o7UKI.png" alt="步驟2"></p>
<ol start="3">
<li>假設印表機是透過網路方式連接，須至設定增加 IP 埠道</li>
</ol>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/cSunWhn.png" alt="步驟3"><br><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/6upmKAf.png" alt="步驟3-2"><br><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/aaC4fTz.png" alt="步驟3-3"></p>
<h2 id="程式實作"><a href="#程式實作" class="headerlink" title="程式實作"></a>程式實作</h2><h3 id="PrintDocument-與-Process"><a href="#PrintDocument-與-Process" class="headerlink" title="PrintDocument 與 Process"></a>PrintDocument 與 Process</h3><p>PrintDocument 類別是 .Net Framework 內建的套件，好處是可以在設定與操作輸出傳送至印表機的物件，可搭配 Process 利用指令列印。</p>
<blockquote>
<p>注意: 當專案部屬在非 Windows 環境中無法作用，其實就是最好只在 .Net Framework 專案中使用。</p>
</blockquote>
<h4 id="使用指令列印"><a href="#使用指令列印" class="headerlink" title="使用指令列印"></a>使用指令列印</h4><p>這邊要使用 <code>Print</code> Verb 時，要先至 Regedit，查看電腦是否有登入此指令</p>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/DdhyIbi.png" alt="步驟1"></p>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/Z5X7uF7.png" alt="步驟2"></p>
<p>如果沒有的話，通常是沒有安裝 <a target="_blank" rel="noopener" href="https://get.adobe.com/tw/reader/">Acrobat Reader</a>，此 PDF 閱讀軟體會自動在電腦上登錄列印紙令，如有此指令便可實作程式碼。</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> pdfPath<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   <span class="token class-name">PrintDocument</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   pd<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>Copies <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 印幾份</span>
   pd<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrinterName <span class="token operator">=</span> <span class="token string">@"印表機名稱"</span><span class="token punctuation">;</span> 
    
    <span class="token comment">// 新增指令</span>
   <span class="token class-name">Process</span> ps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token class-name">ProcessStartInfo</span> startInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   startInfo<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
   startInfo<span class="token punctuation">.</span>Verb <span class="token operator">=</span> <span class="token string">"Print"</span><span class="token punctuation">;</span>
   startInfo<span class="token punctuation">.</span>CreateNoWindow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
   startInfo<span class="token punctuation">.</span>WindowStyle <span class="token operator">=</span> ProcessWindowStyle<span class="token punctuation">.</span>Hidden<span class="token punctuation">;</span>
   startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token string">@"/p /h \" + pdfPath + "</span>\" \"<span class="token string">" + pd.PrinterSettings.PrinterName + "</span> \""<span class="token punctuation">;</span>

   startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> pdfPath<span class="token punctuation">;</span>
   ps<span class="token punctuation">.</span>StartInfo <span class="token operator">=</span> startInfo<span class="token punctuation">;</span>

   ps<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 執行指令</span>
   ps<span class="token punctuation">.</span><span class="token function">WaitForExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ps<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="純-PrintDocument"><a href="#純-PrintDocument" class="headerlink" title="純 PrintDocument"></a>純 PrintDocument</h4><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Printing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>
 
<span class="token keyword">namespace</span> <span class="token namespace">PrintTest</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
 
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            streamToPrint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span>
               <span class="token punctuation">(</span><span class="token string">@"C:\\My Documents\\MyFile.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               
            <span class="token comment">//創建列印物件實體</span>
            <span class="token class-name">PrintDocument</span> printDocument <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 選擇印表機</span>
            printDocument<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrinterName <span class="token operator">=</span> <span class="token string">@"印表機名稱"</span><span class="token punctuation">;</span>
            <span class="token comment">//設定列印用的紙張，可以定義紙張的大小</span>
            printDocument<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>PaperSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PaperSize</span><span class="token punctuation">(</span><span class="token string">"Custom"</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//註冊PrintPage事件，列印每一頁時會觸發</span>
            printDocument<span class="token punctuation">.</span>PrintPage <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPageEventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PrintDocument_PrintPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 開始列印</span>
            printDocument<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            streamToPrint<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PrintDocument_PrintPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Printing<span class="token punctuation">.</span>PrintPageEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">//設置列印内容及其字體，顏色和位置</span>
            e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span><span class="token string">"Hello World！"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Font</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">FontFamily</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Brushes<span class="token punctuation">.</span>Red<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 每行都印</span>
              <span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> linesPerPage <span class="token operator">&amp;&amp;</span>
           <span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> streamToPrint<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            yPos <span class="token operator">=</span> topMargin <span class="token operator">+</span> <span class="token punctuation">(</span>count <span class="token operator">*</span>
               printFont<span class="token punctuation">.</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> printFont<span class="token punctuation">,</span> Brushes<span class="token punctuation">.</span>Black<span class="token punctuation">,</span>
               leftMargin<span class="token punctuation">,</span> yPos<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="FreeSpire-Pdf"><a href="#FreeSpire-Pdf" class="headerlink" title="FreeSpire.Pdf"></a>FreeSpire.Pdf</h3><p><a target="_blank" rel="noopener" href="https://www.gushiciku.cn/pl/2N0Y/zh-tw">https://www.gushiciku.cn/pl/2N0Y/zh-tw</a><br>FreeSpire.Pdf 需使用 Nuget 或指令安裝</p>
<blockquote>
<p>免費社群版本印超過十頁時會報錯，也許你可以寫個每印九頁…</p>
</blockquote>
<ol>
<li>使用預設印表機列印所有頁面<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name">PdfDocument</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PdfDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pd<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">@"C:\File\testPdf.pdf"</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li>指定印表機，設定文件列印範圍<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name">PdfDocument</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PdfDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pd<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">@"C:\File\testPdf.pdf"</span><span class="token punctuation">)</span>
<span class="token comment">// 指定印表機</span>
pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span>PrinterName <span class="token operator">=</span> <span class="token string">"印表機名稱"</span><span class="token punctuation">;</span>
<span class="token comment">// 設定列印頁碼範圍，2~6 頁</span>
pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span><span class="token function">SelectPageRange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or 設定列印不連續的頁面</span>
pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span><span class="token function">SelectSomePages</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>黑白雙面多份列印<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name">PdfDocument</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PdfDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pd<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span><span class="token string">@"C:\File\testPdf.pdf"</span><span class="token punctuation">)</span>
<span class="token comment">// 黑白列印</span>
pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span>Color <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">// 設定多份</span>
pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span>Copies <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">//判斷印表機是否支援雙面列印</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span>CanDuplex<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
     <span class="token comment">//如果支援則設定雙面列印模式，可選：Default/Simplex/Horizontal/Vertical</span>
     pd<span class="token punctuation">.</span>PrintSettings<span class="token punctuation">.</span>Duplex <span class="token operator">=</span> Duplex <span class="token punctuation">.</span> Default <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="PdfiumViewer"><a href="#PdfiumViewer" class="headerlink" title="PdfiumViewer"></a>PdfiumViewer</h3><p>可參考<a target="_blank" rel="noopener" href="https://github.com/pvginkel/PdfiumBuild">官方文件</a>安裝，因為套件作者已沒在維護，所以在 Nuget 中安裝 PdfiumViewer 以外，還需要安裝 pdfiumViewer.Native.x86_64.v8-xfa，這邊推薦安裝 2.10.0 的 PdfiumViewer，安裝完後，專案中會出現 x64 資料夾。</p>
<p><img src="./assets/hexo/img/download.png" data-original="https://i.imgur.com/aMo9UrL.png" alt="PdfiumViewer"></p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> pdfPath <span class="token operator">=</span> <span class="token string">@"資料位置"</span> 
<span class="token keyword">try</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> document <span class="token operator">=</span> PdfDocument<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> printDocument <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">CreatePrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">&#123;</span>
                        printDocument<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrintFileName <span class="token operator">=</span> <span class="token string">"testPdf.pdf"</span><span class="token punctuation">;</span>
                        printDocument<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrinterName <span class="token operator">=</span> <span class="token string">@"印標機名稱"</span><span class="token punctuation">;</span>
                        printDocument<span class="token punctuation">.</span>DocumentName <span class="token operator">=</span> <span class="token string">"file.pdf"</span><span class="token punctuation">;</span>
                        printDocument<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrintFileName <span class="token operator">=</span> <span class="token string">"file.pdf"</span><span class="token punctuation">;</span>
                        printDocument<span class="token punctuation">.</span>PrintController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StandardPrintController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        printDocument<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/dotnet/api/system.drawing.printing.printdocument?view=dotnet-plat-ext-7.0">PrintDocument</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@alexaae9/7-ways-to-print-pdf-in-a-net-application-ab15905bb98f">7 Ways to Print PDF in a .NET Application</a></li>
<li><a target="_blank" rel="noopener" href="https://dotblogs.com.tw/whd/2016/03/22/234526">使用預設印表機列印pdf文件</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.darkthread.net/blog/print-pdf-with-c">使用 C# 批次列印 PDF 檔案</a></li>
<li><a target="_blank" rel="noopener" href="https://www.gushiciku.cn/pl/2N0Y/zh-tw">C# 列印PDF文件的10種方法</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/47857500/c-sharp-how-to-programmatically-print-an-existing-pdf-file-using-printdocument">C# - How to programmatically print an existing PDF file using PrintDocument</a></li>
</ul>

    </div>
  </article>
  <div class="postNext d-flex justify-content-between mt-3 mb-3">
    
      <h4>
        <a href="/Dev-Tech/HexoNestedAngular/">
          <span><<</span>
          <!-- <i class="fa-solid fa-angles-left"></i>  -->
          在 Hexo 中整合 Angular
        </a>
      </h4>
      
        
          <h4>
            <a href="/Dev-Tech/howToUnderstandDDD/">
              新手的領域展開-領域驅動設計 
              <span>>></span>
              <!-- <i class="fa-solid fa-angles-right"></i> -->
            </a>
          </h4>
          
  </div>
  
  <div id="waline"></div>
  <script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    let option = '{"el":"#waline","enable":true,"serverURL":"https://waline-urweb.vercel.app/","placeholder":"歡迎隨時提出您的建議，並不吝指教","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":"en","visitor":true,"comment_count":true,"requiredFields":["nick","mail"],"libUrl":"https://cdnjs.cloudflare.com/ajax/libs/waline/2.14.5/waline.js","pageview":true,"reaction":true}';
    init(JSON.parse(option));
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>
  
    <input style="display:none" onload="addTotalViews()">
</main>
      
        <aside class="rightAside">
          <section>
            <h4>Table of contents</h4>
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D%E9%A9%85%E5%8B%95"><span class="toc-text">安裝驅動</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BC%8F%E5%AF%A6%E4%BD%9C"><span class="toc-text">程式實作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PrintDocument-%E8%88%87-Process"><span class="toc-text">PrintDocument 與 Process</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8C%87%E4%BB%A4%E5%88%97%E5%8D%B0"><span class="toc-text">使用指令列印</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%94-PrintDocument"><span class="toc-text">純 PrintDocument</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FreeSpire-Pdf"><span class="toc-text">FreeSpire.Pdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PdfiumViewer"><span class="toc-text">PdfiumViewer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
          </section>
        </aside>

        <div class="mobileBtn btn">
          <!-- <i class="fa-solid fa-book-bookmark"></i> -->
          <div class="bookmarkIcon"></div>
        </div>

        <div class="modal" tabindex="-1" id="tocModal">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Table of Contents</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                  onclick="tocModalClose()"></button>
              </div>
              <div class="modal-body">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D%E9%A9%85%E5%8B%95"><span class="toc-text">安裝驅動</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BC%8F%E5%AF%A6%E4%BD%9C"><span class="toc-text">程式實作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PrintDocument-%E8%88%87-Process"><span class="toc-text">PrintDocument 與 Process</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8C%87%E4%BB%A4%E5%88%97%E5%8D%B0"><span class="toc-text">使用指令列印</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%94-PrintDocument"><span class="toc-text">純 PrintDocument</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FreeSpire-Pdf"><span class="toc-text">FreeSpire.Pdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PdfiumViewer"><span class="toc-text">PdfiumViewer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
              </div>
            </div>
          </div>
        </div>

        
  </div>
  <footer class="cotainer-fluid">
    <p id="milestone" class="text-center m-0">
      <span>Copyright © 2021-2023 UrWeb. All rights reserved.</span><br>
      <span>This site is in orbit around internet 1 days.</span>
      <span>people witnessed it all</span>
    </p>
  </footer>

  <!-- <h3>categories</h3>
    <ul>
      
      <li>
        <a href="/categories/AI-Tools/"> AI Tools  </a>
      </li>
      
      <li>
        <a href="/categories/Dev-Tech/"> Dev Tech  </a>
      </li>
      
      <li>
        <a href="/categories/%E8%BD%89%E8%81%B7%E6%88%90%E9%95%B7/"> 轉職成長  </a>
      </li>
      
      <li>
        <a href="/categories/f2e/"> f2e  </a>
      </li>
      
      <li>
        <a href="/categories/English/"> English  </a>
      </li>
      
      <li>
        <a href="/categories/Language/"> Language  </a>
      </li>
      
      <li>
        <a href="/categories/Dev/"> Dev  </a>
      </li>
      
    </ul>

    <h3>tags</h3>
    <ul>
      
      <li>
        <a href="/tags/AI/"> AI </a>
      </li>
      
      <li>
        <a href="/tags/Tools/"> Tools </a>
      </li>
      
      <li>
        <a href="/tags/Visual-Studio/"> Visual Studio </a>
      </li>
      
      <li>
        <a href="/tags/C/"> C# </a>
      </li>
      
      <li>
        <a href="/tags/Computer-Science/"> Computer Science </a>
      </li>
      
      <li>
        <a href="/tags/Net/"> .Net </a>
      </li>
      
      <li>
        <a href="/tags/Internet/"> Internet </a>
      </li>
      
      <li>
        <a href="/tags/%E6%88%90%E9%95%B7%E6%80%9D%E7%B6%AD/"> 成長思維 </a>
      </li>
      
      <li>
        <a href="/tags/Exception/"> Exception </a>
      </li>
      
      <li>
        <a href="/tags/Filter/"> Filter </a>
      </li>
      
      <li>
        <a href="/tags/IIS/"> IIS </a>
      </li>
      
      <li>
        <a href="/tags/GTM/"> GTM </a>
      </li>
      
      <li>
        <a href="/tags/f2e/"> f2e </a>
      </li>
      
      <li>
        <a href="/tags/English/"> English </a>
      </li>
      
      <li>
        <a href="/tags/JavaScript/"> JavaScript </a>
      </li>
      
      <li>
        <a href="/tags/Angular/"> Angular </a>
      </li>
      
      <li>
        <a href="/tags/Response/"> Response </a>
      </li>
      
      <li>
        <a href="/tags/Request/"> Request </a>
      </li>
      
      <li>
        <a href="/tags/Javascript/"> Javascript </a>
      </li>
      
      <li>
        <a href="/tags/ES6/"> ES6 </a>
      </li>
      
      <li>
        <a href="/tags/RabbitMQ/"> RabbitMQ </a>
      </li>
      
      <li>
        <a href="/tags/Note/"> Note </a>
      </li>
      
      <li>
        <a href="/tags/React/"> React </a>
      </li>
      
      <li>
        <a href="/tags/Log/"> Log </a>
      </li>
      
      <li>
        <a href="/tags/computer-science/"> computer-science </a>
      </li>
      
      <li>
        <a href="/tags/Git/"> Git </a>
      </li>
      
      <li>
        <a href="/tags/%E8%BD%89%E8%81%B7/"> 轉職 </a>
      </li>
      
      <li>
        <a href="/tags/%E8%A8%AD%E8%A8%88%E6%80%9D%E8%80%83/"> 設計思考 </a>
      </li>
      
      <li>
        <a href="/tags/node-js/"> node.js </a>
      </li>
      
      <li>
        <a href="/tags/npm/"> npm </a>
      </li>
      
      <li>
        <a href="/tags/node/"> node </a>
      </li>
      
      <li>
        <a href="/tags/pnpm/"> pnpm </a>
      </li>
      
      <li>
        <a href="/tags/nvm/"> nvm </a>
      </li>
      
      <li>
        <a href="/tags/nrm/"> nrm </a>
      </li>
      
      <li>
        <a href="/tags/Authorization/"> Authorization </a>
      </li>
      
      <li>
        <a href="/tags/PDF/"> PDF </a>
      </li>
      
      <li>
        <a href="/tags/Architecture/"> Architecture </a>
      </li>
      
      <li>
        <a href="/tags/DDD/"> DDD </a>
      </li>
      
      <li>
        <a href="/tags/OOD-OOP/"> OOD/OOP </a>
      </li>
      
    </ul> -->

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 3,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>


<script src="/js/prism.js"></script>

  
<script src="/js/main.js"></script>


</html>